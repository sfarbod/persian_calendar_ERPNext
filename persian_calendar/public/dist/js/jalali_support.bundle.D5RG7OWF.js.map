{
  "version": 3,
  "sources": ["../../../../../apps/persian_calendar/persian_calendar/public/js/jalali_support/jalaali.js", "../../../../../apps/persian_calendar/persian_calendar/public/js/jalali_support/persian_calendar.js", "../../../../../apps/persian_calendar/persian_calendar/public/js/jalali_support/formatters.js", "../../../../../apps/persian_calendar/persian_calendar/public/js/jalali_support/auto_refresh.js"],
  "sourcesContent": ["(function(){\n  // Use Intl.DateTimeFormat with Persian calendar to derive reliable Jalali parts\n  // Force Latin digits by using en locale with u-ca-persian\n  const fmt = new Intl.DateTimeFormat('en-u-ca-persian', { year:'numeric', month:'2-digit', day:'2-digit'});\n  function toJalaliPartsFromGregorianDate(gDate){\n    const parts = fmt.formatToParts(gDate);\n    const map = Object.fromEntries(parts.map(p=>[p.type,p.value]));\n    const jy = parseInt(map.year, 10);\n    const jm = parseInt(map.month, 10);\n    const jd = parseInt(map.day, 10);\n    return { jy, jm, jd };\n  }\n  function toJalali(gy,gm,gd){\n    return toJalaliPartsFromGregorianDate(new Date(gy, gm-1, gd));\n  }\n\n  // Simple but accurate Jalali to Gregorian conversion\n  function toGregorian(jy, jm, jd) {\n    // Use a more direct approach with Intl.DateTimeFormat\n    // Create a date range and find the exact match\n    const startYear = 2000;\n    const endYear = 2030;\n    \n    for (let year = startYear; year <= endYear; year++) {\n      for (let month = 1; month <= 12; month++) {\n        for (let day = 1; day <= 31; day++) {\n          try {\n            const testDate = new Date(year, month - 1, day);\n            if (testDate.getFullYear() !== year || testDate.getMonth() !== month - 1 || testDate.getDate() !== day) {\n              continue; // Skip invalid dates\n            }\n            \n            const testJalali = toJalaliPartsFromGregorianDate(testDate);\n            \n            if (testJalali.jy === jy && testJalali.jm === jm && testJalali.jd === jd) {\n              return {\n                gy: year,\n                gm: month,\n                gd: day\n              };\n            }\n          } catch (e) {\n            // Skip invalid dates\n            continue;\n          }\n        }\n      }\n    }\n    \n    // If no exact match found, use a more sophisticated fallback\n    // Calculate approximate Gregorian date\n    const jalaliEpoch = new Date(622, 2, 22); // March 22, 622 AD (Jalali year 1)\n    const daysSinceEpoch = (jy - 1) * 365 + (jm - 1) * 30 + (jd - 1);\n    const approximateDate = new Date(jalaliEpoch.getTime() + daysSinceEpoch * 24 * 60 * 60 * 1000);\n    \n    return {\n      gy: approximateDate.getFullYear(),\n      gm: approximateDate.getMonth() + 1,\n      gd: approximateDate.getDate()\n    };\n  }\n\n  // Expose helpers\n  window.toJalali = toJalali;\n  window.toGregorian = toGregorian;\n  window.toJalaliPartsFromGregorianDate = toJalaliPartsFromGregorianDate;\n})();\n\n\n", "(function() {\r\n  frappe.provide(\"frappe.ui.form\");\r\n\r\n  console.log(\"jalali_support script loaded\");\r\n\r\n  // Global variables - will be populated asynchronously\r\n  let jalaliEnabled = null; // null = not checked yet, true/false = checked\r\n  let EFFECTIVE_CALENDAR = {\r\n    display_calendar: \"Jalali\",\r\n    week_start: 6,\r\n    week_end: 5\r\n  };\r\n  let FIRST_DAY = 6;\r\n  \r\n  // Cache for calendar settings to avoid multiple API calls\r\n  let calendarSettingsCache = null;\r\n  let calendarSettingsPromise = null;\r\n\r\n  // Function to get calendar settings (with caching)\r\n  async function getCalendarSettings() {\r\n    if (calendarSettingsCache !== null) {\r\n      return calendarSettingsCache;\r\n    }\r\n    \r\n    if (calendarSettingsPromise) {\r\n      return calendarSettingsPromise;\r\n    }\r\n    \r\n    calendarSettingsPromise = (async () => {\r\n      try {\r\n        // Check if Jalali calendar is enabled\r\n        const result = await frappe.call({ method: \"persian_calendar.jalali_support.api.is_jalali_enabled\" });\r\n        jalaliEnabled = result && result.message;\r\n        console.log(\"Jalali calendar enabled:\", jalaliEnabled);\r\n        \r\n        if (!jalaliEnabled) {\r\n          calendarSettingsCache = { enabled: false, calendar: { display_calendar: \"Gregorian\" } };\r\n          return calendarSettingsCache;\r\n        }\r\n        \r\n        // Get effective calendar settings\r\n        const r = await frappe.call({ method: \"persian_calendar.jalali_support.api.get_effective_calendar\" });\r\n        if (r && r.message) {\r\n          EFFECTIVE_CALENDAR = r.message;\r\n          console.log(\"Effective calendar settings:\", EFFECTIVE_CALENDAR);\r\n        }\r\n        \r\n        FIRST_DAY = EFFECTIVE_CALENDAR.week_start || 6;\r\n        \r\n        calendarSettingsCache = { \r\n          enabled: jalaliEnabled, \r\n          calendar: EFFECTIVE_CALENDAR,\r\n          firstDay: FIRST_DAY\r\n        };\r\n        return calendarSettingsCache;\r\n      } catch(e) {\r\n        console.log(\"Error fetching calendar settings:\", e);\r\n        jalaliEnabled = false;\r\n        calendarSettingsCache = { enabled: false, calendar: { display_calendar: \"Gregorian\" } };\r\n        return calendarSettingsCache;\r\n      }\r\n    })();\r\n    \r\n    return calendarSettingsPromise;\r\n  }\r\n\r\n  // Start loading calendar settings immediately (but don't wait)\r\n  getCalendarSettings();\r\n\r\n  // Helper functions\r\n  function gToJ(gDate) {\r\n    // Check if toJalali is available (from jalaali.js)\r\n    if (typeof toJalali === 'undefined' && typeof window.toJalali !== 'undefined') {\r\n      window.toJalali = window.toJalali;\r\n    }\r\n    if (typeof toJalali === 'undefined') {\r\n      console.error(\"toJalali function is not available! Make sure jalaali.js is loaded.\");\r\n      // Fallback: return a dummy object\r\n      return { jy: 1400, jm: 1, jd: 1 };\r\n    }\r\n    return toJalali(gDate.getFullYear(), gDate.getMonth() + 1, gDate.getDate());\r\n  }\r\n\r\n  function jToG(jy, jm, jd) {\r\n    // Check if toGregorian is available (from jalaali.js)\r\n    if (typeof toGregorian === 'undefined' && typeof window.toGregorian !== 'undefined') {\r\n      window.toGregorian = window.toGregorian;\r\n    }\r\n    if (typeof toGregorian === 'undefined') {\r\n      console.error(\"toGregorian function is not available! Make sure jalaali.js is loaded.\");\r\n      // Fallback: return a dummy object\r\n      return { gy: 2021, gm: 1, gd: 1 };\r\n    }\r\n    return toGregorian(jy, jm, jd);\r\n  }\r\n\r\n  function formatJalaliDate(jy, jm, jd) {\r\n    return `${jy}-${String(jm).padStart(2,\"0\")}-${String(jd).padStart(2,\"0\")}`;\r\n  }\r\n\r\n  function parseJalaliDate(dateStr) {\r\n    const parts = dateStr.split('-').map(Number);\r\n    if (parts.length !== 3) return null;\r\n    return { jy: parts[0], jm: parts[1], jd: parts[2] };\r\n  }\r\n\r\n// Global function to close all Jalali datepickers\r\nfunction closeAllJalaliDatepickers() {\r\n  $('.jalali-datepicker').each(function() {\r\n    const $calendar = $(this);\r\n    const instance = $calendar.data('jalaliDatepickerInstance');\r\n    if (instance && instance.isOpen) {\r\n      instance.close(); // Call the instance's close method to clean up its listeners\r\n    } else {\r\n      $calendar.hide(); // Fallback if instance not found or not open\r\n    }\r\n  });\r\n  \r\n  // No need to remove global handlers here if each instance manages its own\r\n  // The keydown handler is now instance-specific, so no global off needed here.\r\n  \r\n  console.log('All Jalali datepickers closed');\r\n}\r\n\r\n// Enhanced Jalali Datepicker Class\r\nclass JalaliDatepicker {\r\n    constructor(input, controlDate = null) {\r\n      this.input = input;\r\n      this.$input = $(input);\r\n      this.controlDate = controlDate;\r\n      this.isOpen = false;\r\n      this.currentDate = gToJ(new Date());\r\n      this.selectedDate = null;\r\n      this.view = 'days'; // 'days', 'months', 'years'\r\n      this.yearRange = { start: 1400, end: 1410 };\r\n      \r\n      this.init();\r\n    }\r\n\r\n    init() {\r\n      this.createCalendar();\r\n      this.bindEvents();\r\n      this.updateDisplay();\r\n      this.fixAlignment();\r\n      this.$calendar.data('jalaliDatepickerInstance', this); // Store instance\r\n    }\r\n    \r\n    fixAlignment() {\r\n      // Ensure input field alignment matches other form fields using exact Frappe CSS variables\r\n      const $input = this.$input;\r\n      const $wrapper = $input.closest('.form-group, .frappe-control');\r\n      const $formColumn = $input.closest('.form-column');\r\n      \r\n      if ($wrapper.length) {\r\n        // Reset wrapper styles to match Frappe defaults with higher specificity\r\n        $wrapper.css({\r\n          'margin-bottom': '0 !important',\r\n          'padding': '0 !important',\r\n          'vertical-align': 'top !important',\r\n          'display': 'block !important',\r\n          'position': 'relative !important',\r\n          'align-items': 'flex-start !important'\r\n        });\r\n        \r\n        // Apply exact Frappe form control styling with higher specificity - match Gregorian exactly\r\n        $input.css({\r\n          'height': '28px !important', // Exact height like Gregorian\r\n          'line-height': '28px !important', // Exact line-height like Gregorian\r\n          'padding': '6px 8px !important', // Exact padding like Gregorian\r\n          'margin': '0 !important',\r\n          'vertical-align': 'top !important',\r\n          'box-sizing': 'border-box !important',\r\n          'background-color': '#fff !important', // Exact background like Gregorian\r\n          'border': '1px solid #d1d8dd !important', // Exact border like Gregorian\r\n          'border-radius': '4px !important', // Exact border-radius like Gregorian\r\n          'font-size': '13px !important', // Exact font-size like Gregorian\r\n          'font-weight': 'normal !important', // Exact font-weight like Gregorian\r\n          'color': '#36414c !important', // Exact color like Gregorian\r\n          'position': 'relative !important',\r\n          'z-index': '1 !important',\r\n          'display': 'block !important',\r\n          'width': '100% !important',\r\n          'font-family': '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif !important' // Exact font-family like Gregorian\r\n        });\r\n        \r\n        // Ensure the input container has proper positioning\r\n        const $inputContainer = $input.closest('.control-input, .form-control-wrapper');\r\n        if ($inputContainer.length) {\r\n          $inputContainer.css({\r\n            'position': 'relative !important',\r\n            'display': 'block !important',\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'align-items': 'flex-start !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure form column alignment with higher specificity\r\n        if ($formColumn.length) {\r\n          $formColumn.css({\r\n            'vertical-align': 'top !important',\r\n            'display': 'flex !important',\r\n            'flex-direction': 'column !important',\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'align-items': 'stretch !important',\r\n            'justify-content': 'flex-start !important'\r\n          });\r\n        }\r\n        \r\n        // Target the specific form section to ensure proper alignment\r\n        const $formSection = $input.closest('.form-section');\r\n        if ($formSection.length) {\r\n          $formSection.css({\r\n            'display': 'flex !important',\r\n            'flex-direction': 'row !important',\r\n            'align-items': 'flex-start !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure the datepicker doesn't affect layout\r\n        if (this.$calendar && this.$calendar.length) {\r\n          this.$calendar.css({\r\n            'position': 'absolute !important',\r\n            'z-index': '9999 !important',\r\n            'margin': '0 !important',\r\n            'padding': '0 !important'\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    createCalendar() {\r\n      // Remove existing calendar\r\n      this.$input.siblings('.jalali-datepicker').remove();\r\n      \r\n      // Create calendar HTML with exact Gregorian styling\r\n      const calendarHTML = `\r\n        <div class=\"jalali-datepicker\" style=\"\r\n          position: absolute;\r\n          top: 100%;\r\n          left: 0;\r\n          background: var(--bg-color, #fff);\r\n          border: 1px solid var(--border-color, #d1d8dd);\r\n          border-radius: var(--border-radius-sm, 6px);\r\n          box-shadow: var(--shadow-md, 0 2px 8px rgba(0,0,0,0.15));\r\n          z-index: 1000;\r\n          display: none;\r\n          width: 210px;\r\n          padding: 1px;\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          font-size: var(--text-sm, 13px);\r\n          margin-top: 1px;\r\n        \">\r\n          <!-- Header with Navigation -->\r\n          <div class=\"calendar-header\" style=\"\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            margin-bottom: 1px;\r\n            padding-bottom: 1px;\r\n            border-bottom: 1px solid var(--border-color, #e5e7eb);\r\n          \">\r\n            <button type=\"button\" class=\"nav-btn prev-btn\" style=\"\r\n              background: transparent;\r\n              border: none;\r\n              cursor: pointer;\r\n              padding: 1px 3px;\r\n              font-size: 11px;\r\n              color: var(--text-light, #6c7b7f);\r\n              transition: color 0.2s ease;\r\n              border-radius: 4px;\r\n            \">\u2039</button>\r\n            <button type=\"button\" class=\"nav-btn prev-decade\" style=\"\r\n              background: transparent;\r\n              border: none;\r\n              cursor: pointer;\r\n              padding: 1px 3px;\r\n              font-size: 11px;\r\n              color: #6c7b7f;\r\n              transition: color 0.2s ease;\r\n              border-radius: 4px;\r\n            \">\u2039\u2039</button>\r\n            <span class=\"month-year clickable\" style=\"\r\n              font-weight: 500;\r\n              font-size: 12px;\r\n              cursor: pointer;\r\n              padding: 1px 4px;\r\n              color: var(--text-color, #36414c);\r\n              transition: background-color 0.2s ease;\r\n              border-radius: 4px;\r\n            \"></span>\r\n            <button type=\"button\" class=\"nav-btn next-decade\" style=\"\r\n              background: transparent;\r\n              border: none;\r\n              cursor: pointer;\r\n              padding: 1px 3px;\r\n              font-size: 11px;\r\n              color: #6c7b7f;\r\n              transition: color 0.2s ease;\r\n              border-radius: 4px;\r\n            \">\u203A\u203A</button>\r\n            <button type=\"button\" class=\"nav-btn next-btn\" style=\"\r\n              background: transparent;\r\n              border: none;\r\n              cursor: pointer;\r\n              padding: 1px 3px;\r\n              font-size: 11px;\r\n              color: #6c7b7f;\r\n              transition: color 0.2s ease;\r\n              border-radius: 4px;\r\n            \">\u203A</button>\r\n          </div>\r\n          \r\n          <!-- Content Area -->\r\n          <div class=\"calendar-content\">\r\n            <!-- Days View -->\r\n            <div class=\"days-view\">\r\n              <div class=\"weekdays\" style=\"\r\n                display: grid;\r\n                grid-template-columns: repeat(7, 30px);\r\n                gap: 0px;\r\n                margin-bottom: 0px;\r\n              \"></div>\r\n              <div class=\"days-grid\" style=\"\r\n                display: grid;\r\n                grid-template-columns: repeat(7, 30px);\r\n                gap: 0px;\r\n              \"></div>\r\n            </div>\r\n            \r\n            <!-- Months View -->\r\n            <div class=\"months-view\" style=\"display: none;\">\r\n              <div class=\"months-grid\" style=\"\r\n                display: grid;\r\n                grid-template-columns: repeat(3, 1fr);\r\n                gap: 1px;\r\n                padding: 1px 0;\r\n              \"></div>\r\n            </div>\r\n            \r\n            <!-- Years View -->\r\n            <div class=\"years-view\" style=\"display: none;\">\r\n              <div class=\"years-grid\" style=\"\r\n                display: grid;\r\n                grid-template-columns: repeat(4, 1fr);\r\n                gap: 1px;\r\n                padding: 1px 0;\r\n              \"></div>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- Footer -->\r\n          <div class=\"calendar-footer\" style=\"\r\n            margin-top: 1px;\r\n            padding-top: 1px;\r\n            border-top: 1px solid var(--border-color, #eee);\r\n            text-align: center;\r\n          \">\r\n            <button type=\"button\" class=\"today-btn\" style=\"\r\n              background: transparent;\r\n              color: var(--text-color, #36414c);\r\n              border: 1px solid var(--border-color, #d1d8dd);\r\n              padding: 2px 8px;\r\n              border-radius: 3px;\r\n              cursor: pointer;\r\n              font-size: 12px;\r\n              font-weight: normal;\r\n              transition: all 0.2s ease;\r\n              font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n              width: 100%;\r\n            \">\u0627\u0645\u0631\u0648\u0632</button>\r\n          </div>\r\n        </div>\r\n      `;\r\n      \r\n      this.$calendar = $(calendarHTML);\r\n      this.$input.after(this.$calendar);\r\n      \r\n      console.log(\"Jalali datepicker created\");\r\n    }\r\n\r\n    bindEvents() {\r\n      const self = this;\r\n      \r\n      // Input click\r\n      this.$input.on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.toggle();\r\n      });\r\n      \r\n      // Month/Year navigation\r\n      this.$calendar.find('.prev-btn').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.navigateMonth(-1);\r\n      });\r\n      \r\n      this.$calendar.find('.next-btn').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.navigateMonth(1);\r\n      });\r\n      \r\n      // Month/Year click to switch views\r\n      this.$calendar.find('.month-year').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        \r\n        // Switch views based on current view\r\n        if (self.view === 'days') {\r\n          self.showMonthsView();\r\n        } else if (self.view === 'months') {\r\n          self.showYearsView();\r\n        } else if (self.view === 'years') {\r\n          self.showMonthsView();\r\n        }\r\n      });\r\n      \r\n      // Year navigation\r\n      this.$calendar.find('.prev-decade').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.navigateYear(-10);\r\n      });\r\n      \r\n      this.$calendar.find('.next-decade').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.navigateYear(10);\r\n      });\r\n      \r\n      // Today button\r\n      this.$calendar.find('.today-btn').on('click', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        self.selectToday();\r\n      });\r\n      \r\n      // Simple click outside to close\r\n      $(document).on('click.jalali-datepicker-global', function(e) {\r\n        if (self.isOpen) {\r\n          const $target = $(e.target);\r\n          // Close if clicking outside the datepicker and not on the input field\r\n          if (!$target.closest('.jalali-datepicker').length && \r\n              !$target.is(self.input)) {\r\n            console.log('Closing datepicker due to click outside');\r\n            self.close();\r\n          }\r\n        }\r\n      });\r\n      \r\n      // Close when clicking on any date input field\r\n      $(document).on('click.jalali-datepicker-date-inputs', function(e) {\r\n        if (self.isOpen) {\r\n          const $target = $(e.target);\r\n          // Close if clicking on any date input field that's not our current input\r\n          if ($target.is('input[data-fieldtype=\"Date\"]') && \r\n              !$target.is(self.input)) {\r\n            console.log('Closing datepicker due to click on another date field');\r\n            self.close();\r\n          }\r\n        }\r\n      });\r\n      \r\n      // ESC key to close - make it instance specific\r\n      this._keydownHandler = function(e) {\r\n        if (e.keyCode === 27 && self.isOpen) { // ESC\r\n          self.close();\r\n        }\r\n      };\r\n      $(document).on('keydown.jalali-datepicker-' + (this.input.id || 'default'), this._keydownHandler);\r\n\r\n      // Use native event listener for capturing phase to ensure clicks outside are caught\r\n      // This is more robust against e.stopPropagation() from other elements\r\n      this._globalClickListener = function(e) {\r\n        if (self.isOpen) {\r\n          const $target = $(e.target);\r\n          const isClickInsideDatepicker = $target.closest('.jalali-datepicker').length > 0;\r\n          const isClickOnOwnInput = $target.is(self.input);\r\n\r\n          if (!isClickInsideDatepicker && !isClickOnOwnInput) {\r\n            console.log('Capturing phase: Closing datepicker due to click outside (general)');\r\n            self.close();\r\n          }\r\n        }\r\n      };\r\n      document.addEventListener('click', this._globalClickListener, true); // true for capturing phase\r\n      \r\n      // Add hover effects\r\n      this.$calendar.find('.nav-btn').hover(\r\n        function() { $(this).css('background-color', '#f8f9fa'); },\r\n        function() { $(this).css('background-color', 'transparent'); }\r\n      );\r\n      \r\n      this.$calendar.find('.month-year').hover(\r\n        function() { $(this).css('background-color', '#f8f9fa'); },\r\n        function() { $(this).css('background-color', 'transparent'); }\r\n      );\r\n    }\r\n\r\n    toggle() {\r\n      if (this.isOpen) {\r\n        this.close();\r\n      } else {\r\n        // Always reset to days view when opening\r\n        this.view = 'days';\r\n        this.open();\r\n      }\r\n    }\r\n\r\n    open() {\r\n      // Close all other Jalali datepickers first\r\n      closeAllJalaliDatepickers();\r\n      \r\n      this.isOpen = true;\r\n      this.view = 'days'; // Always reset to days view\r\n      this.updateDisplay(); // Update display to show current date\r\n      this.updateCalendar();\r\n      this.$calendar.show();\r\n      console.log(\"Calendar opened with view:\", this.view);\r\n    }\r\n\r\n    close() {\r\n      this.isOpen = false;\r\n      this.$calendar.hide();\r\n      \r\n      // Remove event handlers to prevent memory leaks\r\n      if (this._keydownHandler) {\r\n        $(document).off('keydown.jalali-datepicker-' + (this.input.id || 'default'), this._keydownHandler);\r\n        this._keydownHandler = null;\r\n      }\r\n      if (this._globalClickListener) {\r\n        document.removeEventListener('click', this._globalClickListener, true);\r\n        this._globalClickListener = null;\r\n      }\r\n      \r\n      console.log(\"Calendar closed\");\r\n    }\r\n    \r\n    // Navigation methods\r\n    navigateMonth(direction) {\r\n      if (this.view === 'days') {\r\n        this.currentDate.jm += direction;\r\n        if (this.currentDate.jm > 12) {\r\n          this.currentDate.jm = 1;\r\n          this.currentDate.jy++;\r\n        } else if (this.currentDate.jm < 1) {\r\n          this.currentDate.jm = 12;\r\n          this.currentDate.jy--;\r\n        }\r\n        this.updateCalendar();\r\n      } else if (this.view === 'months') {\r\n        // In months view, navigate year by year\r\n        this.currentDate.jy += direction;\r\n        this.updateMonthsView();\r\n      }\r\n    }\r\n    \r\n    navigateYear(direction) {\r\n      // Navigate by decade (like Gregorian calendar)\r\n      this.yearRange.start += direction;\r\n      this.yearRange.end += direction;\r\n      \r\n      // Update current year to center of new range\r\n      this.currentDate.jy = this.yearRange.start + 4; // Middle of decade\r\n      \r\n      this.updateYearsView();\r\n    }\r\n    \r\n    // View switching methods\r\n    showMonthsView() {\r\n      this.view = 'months';\r\n      this.updateMonthsView();\r\n      this.$calendar.find('.days-view').hide();\r\n      this.$calendar.find('.years-view').hide();\r\n      this.$calendar.find('.months-view').show();\r\n    }\r\n    \r\n    showYearsView() {\r\n      this.view = 'years';\r\n      this.updateYearsView();\r\n      this.$calendar.find('.days-view').hide();\r\n      this.$calendar.find('.months-view').hide();\r\n      this.$calendar.find('.years-view').show();\r\n    }\r\n    \r\n    showDaysView() {\r\n      this.view = 'days';\r\n      this.updateCalendar();\r\n      this.$calendar.find('.months-view').hide();\r\n      this.$calendar.find('.years-view').hide();\r\n      this.$calendar.find('.days-view').show();\r\n    }\r\n\r\n    updateCalendar() {\r\n      const monthNames = ['\u0641\u0631\u0648\u0631\u062F\u06CC\u0646', '\u0627\u0631\u062F\u06CC\u0628\u0647\u0634\u062A', '\u062E\u0631\u062F\u0627\u062F', '\u062A\u06CC\u0631', '\u0645\u0631\u062F\u0627\u062F', '\u0634\u0647\u0631\u06CC\u0648\u0631', \r\n                        '\u0645\u0647\u0631', '\u0622\u0628\u0627\u0646', '\u0622\u0630\u0631', '\u062F\u06CC', '\u0628\u0647\u0645\u0646', '\u0627\u0633\u0641\u0646\u062F'];\r\n      \r\n      // Update header\r\n      this.$calendar.find('.month-year').text(`${monthNames[this.currentDate.jm - 1]} ${this.currentDate.jy}`);\r\n      \r\n      // Show/hide navigation buttons\r\n      this.$calendar.find('.prev-btn, .next-btn').show();\r\n      this.$calendar.find('.prev-decade, .next-decade').hide();\r\n      \r\n      // Hide all views first\r\n      this.$calendar.find('.days-view').hide();\r\n      this.$calendar.find('.months-view').hide();\r\n      this.$calendar.find('.years-view').hide();\r\n      \r\n      // Show only the current view\r\n      if (this.view === 'days') {\r\n        this.$calendar.find('.days-view').show();\r\n        // Update weekdays based on FIRST_DAY\r\n        this.updateWeekdays();\r\n        // Update days\r\n        this.updateDays();\r\n      } else if (this.view === 'months') {\r\n        this.$calendar.find('.months-view').show();\r\n        this.updateMonthsView();\r\n      } else if (this.view === 'years') {\r\n        this.$calendar.find('.years-view').show();\r\n        this.updateYearsView();\r\n      }\r\n    }\r\n    \r\n    updateWeekdays() {\r\n      // \u062A\u0631\u062A\u06CC\u0628 \u0635\u062D\u06CC\u062D \u0631\u0648\u0632\u0647\u0627\u06CC \u0647\u0641\u062A\u0647 \u0628\u0631 \u0627\u0633\u0627\u0633 \u062A\u0646\u0638\u06CC\u0645\u0627\u062A: \u0634\u0646\u0628\u0647=6, \u06CC\u06A9\u0634\u0646\u0628\u0647=0, \u062F\u0648\u0634\u0646\u0628\u0647=1, \u0633\u0647\u200C\u0634\u0646\u0628\u0647=2, \u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647=3, \u067E\u0646\u062C\u200C\u0634\u0646\u0628\u0647=4, \u062C\u0645\u0639\u0647=5\r\n      const weekdayNames = ['\u06CC', '\u062F', '\u0633', '\u0686', '\u067E', '\u062C', '\u0634']; // [\u06CC\u06A9\u0634\u0646\u0628\u0647, \u062F\u0648\u0634\u0646\u0628\u0647, \u0633\u0647\u200C\u0634\u0646\u0628\u0647, \u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647, \u067E\u0646\u062C\u200C\u0634\u0646\u0628\u0647, \u062C\u0645\u0639\u0647, \u0634\u0646\u0628\u0647]\r\n      const $weekdaysContainer = this.$calendar.find('.weekdays');\r\n      $weekdaysContainer.empty();\r\n      \r\n      // \u0628\u0627 \u062A\u0648\u062C\u0647 \u0628\u0647 FIRST_DAY = 6 (\u0634\u0646\u0628\u0647)\u060C \u062A\u0631\u062A\u06CC\u0628 \u0646\u0645\u0627\u06CC\u0634 \u0628\u0627\u06CC\u062F: \u0634\u0646\u0628\u0647, \u06CC\u06A9\u0634\u0646\u0628\u0647, \u062F\u0648\u0634\u0646\u0628\u0647, \u0633\u0647\u200C\u0634\u0646\u0628\u0647, \u0686\u0647\u0627\u0631\u0634\u0646\u0628\u0647, \u067E\u0646\u062C\u200C\u0634\u0646\u0628\u0647, \u062C\u0645\u0639\u0647\r\n      for (let i = 0; i < 7; i++) {\r\n        const dayIndex = (FIRST_DAY + i) % 7;\r\n        $weekdaysContainer.append($(`<div class=\"weekday\" style=\"text-align: center; padding: 0; font-weight: 500; font-size: 9px; color: var(--text-light, #7c7c7c); font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif); width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;\">${weekdayNames[dayIndex]}</div>`));\r\n      }\r\n    }\r\n\r\n    updateDays() {\r\n      const $daysGrid = this.$calendar.find('.days-grid');\r\n      $daysGrid.empty();\r\n      \r\n      const daysInMonth = this.currentDate.jm <= 6 ? 31 : \r\n                         (this.currentDate.jm <= 11 ? 30 : \r\n                         (this.currentDate.jy % 4 === 3 ? 30 : 29));\r\n      \r\n      // Get first day of month (Saturday = 0)\r\n      const firstDay = this.getFirstDayOfMonth(this.currentDate.jy, this.currentDate.jm);\r\n      \r\n      // Calculate previous month's last days\r\n      let prevMonth = this.currentDate.jm - 1;\r\n      let prevYear = this.currentDate.jy;\r\n      if (prevMonth < 1) {\r\n        prevMonth = 12;\r\n        prevYear--;\r\n      }\r\n      const prevMonthDays = prevMonth <= 6 ? 31 : \r\n                           (prevMonth <= 11 ? 30 : \r\n                           (prevYear % 4 === 3 ? 30 : 29));\r\n      \r\n      // Add previous month's last days (light color, selectable)\r\n      for (let i = firstDay - 1; i >= 0; i--) {\r\n        const day = prevMonthDays - i;\r\n        const $prevDay = $(`<div class=\"day-cell prev-month-day\" data-day=\"${day}\" data-month=\"${prevMonth}\" data-year=\"${prevYear}\" style=\"\r\n          text-align: center;\r\n          padding: 0;\r\n          cursor: pointer;\r\n          border-radius: 0;\r\n          transition: all 0.2s ease;\r\n          font-size: 11px;\r\n          color: var(--text-light, #999);\r\n          width: 30px;\r\n          height: 30px;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          border: none;\r\n          background: transparent;\r\n        \">${day}</div>`);\r\n        \r\n        // Add click handler for previous month days - select the day directly\r\n        $prevDay.on('click', (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.currentDate.jy = prevYear;\r\n          this.currentDate.jm = prevMonth;\r\n          this.currentDate.jd = day;\r\n          this.selectDate(day);\r\n        });\r\n        \r\n        // Add hover effect\r\n        $prevDay.hover(\r\n          function() { $(this).css('background-color', '#f8f9fa'); },\r\n          function() { $(this).css('background-color', 'transparent'); }\r\n        );\r\n        \r\n        $daysGrid.append($prevDay);\r\n      }\r\n      \r\n      for (let day = 1; day <= daysInMonth; day++) {\r\n        const $day = $(`<div class=\"day-cell\" data-day=\"${day}\" style=\"\r\n          text-align: center;\r\n          padding: 0;\r\n          cursor: pointer;\r\n          border-radius: 0;\r\n          transition: all 0.2s ease;\r\n          font-size: 11px;\r\n          color: var(--text-color, #36414c);\r\n          width: 30px;\r\n          height: 30px;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          border: none;\r\n          background: transparent;\r\n        \">${day}</div>`);\r\n        \r\n        // Add click handler\r\n        $day.on('click', (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.selectDate(day);\r\n        });\r\n        \r\n        // Add hover effects\r\n        $day.hover(\r\n          function() { \r\n            if (!$(this).hasClass('selected') && !$(this).hasClass('today')) {\r\n              $(this).css('background-color', '#f8f9fa');\r\n            }\r\n          },\r\n          function() { \r\n            if (!$(this).hasClass('selected') && !$(this).hasClass('today')) {\r\n              $(this).css('background-color', 'transparent');\r\n            }\r\n          }\r\n        );\r\n        \r\n        // Highlight today (gray background like Gregorian)\r\n        const today = gToJ(new Date());\r\n        if (this.currentDate.jy === today.jy && \r\n            this.currentDate.jm === today.jm && \r\n            day === today.jd) {\r\n          $day.addClass('today').css({\r\n            'background-color': 'var(--control-bg, #f3f3f3)',\r\n            'color': 'var(--text-color, #36414c)',\r\n            'font-weight': 'bold'\r\n          });\r\n        }\r\n        \r\n        // Highlight selected day (black background like Gregorian)\r\n        if (this.selectedDate && \r\n            this.selectedDate.jy === this.currentDate.jy &&\r\n            this.selectedDate.jm === this.currentDate.jm &&\r\n            this.selectedDate.jd === day) {\r\n          $day.addClass('selected').css({\r\n            'background-color': 'var(--primary, #171717)',\r\n            'color': 'var(--bg-color, white)',\r\n            'font-weight': 'bold'\r\n          });\r\n        }\r\n        \r\n        $daysGrid.append($day);\r\n      }\r\n      \r\n      // Calculate next month's first days\r\n      let nextMonth = this.currentDate.jm + 1;\r\n      let nextYear = this.currentDate.jy;\r\n      if (nextMonth > 12) {\r\n        nextMonth = 1;\r\n        nextYear++;\r\n      }\r\n      \r\n      // Calculate how many cells we need to fill to complete the grid (6 rows = 42 cells)\r\n      const totalCells = 42; // 6 rows * 7 days\r\n      const currentCells = firstDay + daysInMonth;\r\n      const remainingCells = totalCells - currentCells;\r\n      \r\n      // Add next month's first days (light color, selectable)\r\n      for (let day = 1; day <= remainingCells; day++) {\r\n        const $nextDay = $(`<div class=\"day-cell next-month-day\" data-day=\"${day}\" data-month=\"${nextMonth}\" data-year=\"${nextYear}\" style=\"\r\n          text-align: center;\r\n          padding: 0;\r\n          cursor: pointer;\r\n          border-radius: 0;\r\n          transition: all 0.2s ease;\r\n          font-size: 11px;\r\n          color: var(--text-light, #999);\r\n          width: 30px;\r\n          height: 30px;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          border: none;\r\n          background: transparent;\r\n        \">${day}</div>`);\r\n        \r\n        // Add click handler for next month days - select the day directly\r\n        $nextDay.on('click', (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.currentDate.jy = nextYear;\r\n          this.currentDate.jm = nextMonth;\r\n          this.currentDate.jd = day;\r\n          this.selectDate(day);\r\n        });\r\n        \r\n        // Add hover effect\r\n        $nextDay.hover(\r\n          function() { $(this).css('background-color', '#f8f9fa'); },\r\n          function() { $(this).css('background-color', 'transparent'); }\r\n        );\r\n        \r\n        $daysGrid.append($nextDay);\r\n      }\r\n      \r\n      console.log(`Updated calendar with ${daysInMonth} days`);\r\n    }\r\n\r\n    selectDate(day) {\r\n      this.selectedDate = {\r\n        jy: this.currentDate.jy,\r\n        jm: this.currentDate.jm,\r\n        jd: day\r\n      };\r\n      \r\n      const jalaliStr = formatJalaliDate(this.selectedDate.jy, this.selectedDate.jm, this.selectedDate.jd);\r\n      \r\n      // Convert to Gregorian for storage\r\n      const gregorian = jToG(this.selectedDate.jy, this.selectedDate.jm, this.selectedDate.jd);\r\n      const gregorianStr = `${gregorian.gy}-${String(gregorian.gm).padStart(2, '0')}-${String(gregorian.gd).padStart(2, '0')}`;\r\n      \r\n      console.log(`Converting Jalali ${jalaliStr} to Gregorian ${gregorianStr}`);\r\n      \r\n      // Set the Gregorian value in Frappe's system\r\n      if (this.controlDate && this.controlDate.set_value) {\r\n        this.controlDate.set_value(gregorianStr);\r\n        this.$input.val(jalaliStr);\r\n      } else {\r\n        // Fallback: just set the input value\r\n        this.$input.val(jalaliStr);\r\n        this.$input.trigger('change');\r\n      }\r\n      \r\n      this.close();\r\n      console.log(`Selected date: ${jalaliStr} (${gregorianStr})`);\r\n    }\r\n\r\n    selectToday() {\r\n      const today = gToJ(new Date());\r\n      console.log('Today in Jalali:', today);\r\n      \r\n      // Update current date to today's month/year\r\n      this.currentDate = { ...today };\r\n      \r\n      // Switch to days view to show the calendar properly\r\n      this.view = 'days';\r\n      \r\n      // Update calendar display\r\n      this.updateCalendar();\r\n      \r\n      // Select today's date\r\n      this.selectDate(today.jd);\r\n    }\r\n\r\n    prevMonth() {\r\n      if (this.currentDate.jm === 1) {\r\n        this.currentDate.jm = 12;\r\n        this.currentDate.jy--;\r\n      } else {\r\n        this.currentDate.jm--;\r\n      }\r\n      this.updateCalendar();\r\n    }\r\n\r\n    nextMonth() {\r\n      if (this.currentDate.jm === 12) {\r\n        this.currentDate.jm = 1;\r\n        this.currentDate.jy++;\r\n      } else {\r\n        this.currentDate.jm++;\r\n      }\r\n      this.updateCalendar();\r\n    }\r\n\r\n    updateDisplay() {\r\n      const value = this.$input.val();\r\n      if (value) {\r\n        const jalali = parseJalaliDate(value);\r\n        if (jalali) {\r\n          this.selectedDate = jalali;\r\n          this.currentDate = { ...jalali };\r\n        }\r\n      }\r\n      \r\n      // Always reset to days view when updating display\r\n      this.view = 'days';\r\n    }\r\n    \r\n    // Month/Year view methods\r\n    updateMonthsView() {\r\n      // Update header to show only year\r\n      this.$calendar.find('.month-year').text(`${this.currentDate.jy}`);\r\n      \r\n      // Hide/show navigation buttons - use year-by-year navigation for months view\r\n      this.$calendar.find('.prev-btn, .next-btn').show();\r\n      this.$calendar.find('.prev-decade, .next-decade').hide();\r\n      \r\n      const monthNames = ['\u0641\u0631\u0648\u0631\u062F\u06CC\u0646', '\u0627\u0631\u062F\u06CC\u0628\u0647\u0634\u062A', '\u062E\u0631\u062F\u0627\u062F', '\u062A\u06CC\u0631', '\u0645\u0631\u062F\u0627\u062F', '\u0634\u0647\u0631\u06CC\u0648\u0631', \r\n                        '\u0645\u0647\u0631', '\u0622\u0628\u0627\u0646', '\u0622\u0630\u0631', '\u062F\u06CC', '\u0628\u0647\u0645\u0646', '\u0627\u0633\u0641\u0646\u062F'];\r\n      \r\n      const $monthsGrid = this.$calendar.find('.months-grid');\r\n      $monthsGrid.empty();\r\n      \r\n      monthNames.forEach((month, index) => {\r\n        const $month = $(`<div class=\"month-cell\" data-month=\"${index + 1}\" style=\"\r\n          text-align: center;\r\n          padding: 3px 2px;\r\n          cursor: pointer;\r\n          border-radius: 0;\r\n          transition: all 0.2s ease;\r\n          font-size: 11px;\r\n          color: var(--text-color, #36414c);\r\n          border: 1px solid var(--border-color, #e2e2e2);\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          background: transparent;\r\n        \">${month}</div>`);\r\n        \r\n        // Add click handler\r\n        $month.on('click', (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.currentDate.jm = index + 1;\r\n          this.showDaysView();\r\n        });\r\n        \r\n        // Add hover effects\r\n        $month.hover(\r\n          function() { \r\n            if (!$(this).hasClass('selected')) {\r\n              $(this).css('background-color', '#f8f9fa');\r\n            }\r\n          },\r\n          function() { \r\n            if (!$(this).hasClass('selected')) {\r\n              $(this).css('background-color', 'transparent');\r\n            }\r\n          }\r\n        );\r\n        \r\n        // Check if current month - use site theme colors like Gregorian\r\n        if (this.currentDate.jm === index + 1) {\r\n          $month.addClass('selected').css({\r\n            'background-color': 'var(--primary, #171717)',\r\n            'color': 'var(--bg-color, white)',\r\n            'font-weight': 'bold'\r\n          });\r\n        }\r\n        \r\n        $monthsGrid.append($month);\r\n      });\r\n    }\r\n    \r\n    updateYearsView() {\r\n      // Calculate year range centered around current year (like Gregorian calendar)\r\n      const currentYear = this.currentDate.jy;\r\n      const startYear = Math.floor(currentYear / 10) * 10; // Round down to decade\r\n      const endYear = startYear + 9;\r\n      \r\n      // Update yearRange for navigation\r\n      this.yearRange = { start: startYear, end: endYear };\r\n      \r\n      // Update header to show year range\r\n      this.$calendar.find('.month-year').text(`${this.yearRange.start} - ${this.yearRange.end}`);\r\n      \r\n      // Hide/show navigation buttons\r\n      this.$calendar.find('.prev-btn, .next-btn').hide();\r\n      this.$calendar.find('.prev-decade, .next-decade').show();\r\n      \r\n      const $yearsGrid = this.$calendar.find('.years-grid');\r\n      $yearsGrid.empty();\r\n      \r\n      // Show years from startYear-1 to endYear+1 (like Gregorian calendar)\r\n      for (let year = startYear - 1; year <= endYear + 1; year++) {\r\n        const $year = $(`<div class=\"year-cell\" data-year=\"${year}\" style=\"\r\n          text-align: center;\r\n          padding: 3px 2px;\r\n          cursor: pointer;\r\n          border-radius: 0;\r\n          transition: all 0.2s ease;\r\n          font-size: 11px;\r\n          color: var(--text-color, #36414c);\r\n          border: 1px solid var(--border-color, #e2e2e2);\r\n          font-family: var(--font-stack, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);\r\n          background: transparent;\r\n        \">${year}</div>`);\r\n        \r\n        // Add click handler\r\n        $year.on('click', (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.currentDate.jy = year;\r\n          this.showMonthsView();\r\n        });\r\n        \r\n        // Add hover effects\r\n        $year.hover(\r\n          function() { \r\n            if (!$(this).hasClass('selected')) {\r\n              $(this).css('background-color', '#f8f9fa');\r\n            }\r\n          },\r\n          function() { \r\n            if (!$(this).hasClass('selected')) {\r\n              $(this).css('background-color', 'transparent');\r\n            }\r\n          }\r\n        );\r\n        \r\n        // Check if current year - use site theme colors like Gregorian\r\n        if (this.currentDate.jy === year) {\r\n          $year.addClass('selected').css({\r\n            'background-color': 'var(--primary, #171717) !important',\r\n            'color': 'var(--bg-color, white) !important',\r\n            'font-weight': 'bold !important'\r\n          });\r\n        }\r\n        \r\n        // Make years outside range faded (like Gregorian calendar)\r\n        if (year < startYear || year > endYear) {\r\n          $year.addClass('other-decade').css({\r\n            'color': 'var(--text-light, #999) !important',\r\n            'cursor': 'not-allowed !important',\r\n            'opacity': '0.4 !important'\r\n          });\r\n          \r\n          // Disable click for years outside range\r\n          $year.off('click').on('click', (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            // Do nothing for years outside range\r\n          });\r\n          \r\n          // Remove hover effect for years outside range\r\n          $year.off('mouseenter mouseleave');\r\n        }\r\n        \r\n        $yearsGrid.append($year);\r\n      }\r\n    }\r\n    \r\n    getFirstDayOfMonth(year, month) {\r\n      // Calculate first day of Jalali month\r\n      // Convert Jalali date to Gregorian to get the weekday\r\n      const gregorian = jToG(year, month, 1);\r\n      const date = new Date(gregorian.gy, gregorian.gm - 1, gregorian.gd);\r\n      \r\n      // Convert JavaScript weekday (Sunday=0) to our weekday system (Saturday=0)\r\n      // JavaScript: Sunday=0, Monday=1, Tuesday=2, Wednesday=3, Thursday=4, Friday=5, Saturday=6\r\n      // Our system: Saturday=0, Sunday=1, Monday=2, Tuesday=3, Wednesday=4, Thursday=5, Friday=6\r\n      const jsWeekday = date.getDay(); // 0=Sunday, 6=Saturday\r\n      return (jsWeekday + 1) % 7; // Convert to our system: Saturday=0, Sunday=1, etc.\r\n    }\r\n  }\r\n\r\n  // Override Frappe's ControlDate\r\n  function overrideControlsWhenReady() {\r\n    const hasControls = frappe && frappe.ui && frappe.ui.form && frappe.ui.form.ControlDate;\r\n    if (!hasControls) {\r\n      // Try again after a short delay\r\n      setTimeout(overrideControlsWhenReady, 50);\r\n      return;\r\n    }\r\n\r\n    // Check if already overridden\r\n    if (frappe.ui.form.ControlDate.prototype.replaceWithJalaliDatepicker) {\r\n      console.log(\"ControlDate already patched for Jalali\");\r\n      return;\r\n    }\r\n\r\n    const BaseControlDate = frappe.ui.form.ControlDate;\r\n\r\n    class JalaliControlDate extends BaseControlDate {\r\n      make_input() {\r\n        // Always call parent first to get standard Frappe input structure\r\n        super.make_input();\r\n        \r\n        // Check if we should use Jalali datepicker\r\n        // If cache is not loaded yet, assume Jalali is enabled (default behavior)\r\n        let useJalali = true;\r\n        let display_calendar = \"Jalali\";\r\n        \r\n        if (calendarSettingsCache !== null) {\r\n          // Settings are loaded - check them\r\n          useJalali = calendarSettingsCache.enabled && \r\n                     calendarSettingsCache.calendar?.display_calendar !== \"Gregorian\";\r\n          display_calendar = calendarSettingsCache.calendar?.display_calendar || \"Jalali\";\r\n          \r\n          // Update globals\r\n          if (calendarSettingsCache.calendar) {\r\n            EFFECTIVE_CALENDAR = calendarSettingsCache.calendar;\r\n          }\r\n          if (calendarSettingsCache.firstDay !== undefined) {\r\n            FIRST_DAY = calendarSettingsCache.firstDay;\r\n          }\r\n        } else {\r\n          // Settings not loaded yet - start loading in background\r\n          // For now, use Jalali by default (will be corrected if needed)\r\n          getCalendarSettings().then(settings => {\r\n            // If settings show Gregorian, we need to switch to Gregorian\r\n            if (!settings.enabled || settings.calendar?.display_calendar === \"Gregorian\") {\r\n              // Remove Jalali datepicker and reinitialize with Gregorian\r\n              if (this.jalaliDatepicker) {\r\n                this.removeAirDatepickerInstances();\r\n                this.jalaliDatepicker = null;\r\n                // Reinitialize with Gregorian\r\n                super.make_input();\r\n              }\r\n            } else {\r\n              // Update globals\r\n              if (settings.calendar) {\r\n                EFFECTIVE_CALENDAR = settings.calendar;\r\n              }\r\n              if (settings.firstDay !== undefined) {\r\n                FIRST_DAY = settings.firstDay;\r\n              }\r\n              // Update datepicker if it exists\r\n              if (this.jalaliDatepicker) {\r\n                this.jalaliDatepicker.updateDisplay();\r\n              }\r\n            }\r\n          });\r\n        }\r\n        \r\n        // Store display_calendar for later use\r\n        this.display_calendar = display_calendar;\r\n        \r\n        // Replace the air-datepicker with our Jalali datepicker (if enabled)\r\n        if (useJalali) {\r\n          this.replaceWithJalaliDatepicker();\r\n        }\r\n      }\r\n      \r\n      replaceWithJalaliDatepicker() {\r\n        // Find the input element\r\n        this.$input = this.$wrapper.find('input');\r\n        if (!this.$input.length) {\r\n          this.$input = $(`<input class=\"form-control\" type=\"text\">`);\r\n          this.$wrapper.append(this.$input);\r\n        }\r\n        \r\n        // Remove any existing air-datepicker instances\r\n        this.removeAirDatepickerInstances();\r\n        \r\n        // Remove any air-datepicker-related attributes and classes\r\n        this.$input.removeAttr('data-date-format');\r\n        this.$input.removeAttr('data-alt-input');\r\n        this.$input.removeAttr('data-alt-format');\r\n        this.$input.removeClass('datepicker-input');\r\n        this.$input.removeClass('hasDatepicker');\r\n        \r\n        // Make input editable for better UX\r\n        this.$input.attr('readonly', false);\r\n        \r\n        // Apply exact Frappe form control styling to match other fields with higher specificity\r\n        this.$input.css({\r\n          'height': 'var(--input-height) !important', // 28px\r\n          'line-height': 'var(--input-height) !important', // 28px\r\n          'padding': 'var(--input-padding) !important', // 6px 8px\r\n          'margin': '0 !important',\r\n          'vertical-align': 'top !important',\r\n          'box-sizing': 'border-box !important',\r\n          'background-color': 'var(--control-bg) !important',\r\n          'border': '1px solid var(--border-color) !important',\r\n          'border-radius': 'var(--border-radius-sm) !important',\r\n          'font-size': 'var(--text-base) !important',\r\n          'font-weight': 'var(--font-weight-regular) !important',\r\n          'color': 'var(--text-color) !important',\r\n          'position': 'relative !important',\r\n          'z-index': '1 !important',\r\n          'display': 'block !important',\r\n          'width': '100% !important'\r\n        });\r\n        \r\n        // Fix the control-input-wrapper to match other fields\r\n        const $controlInputWrapper = this.$wrapper.find('.control-input-wrapper');\r\n        if ($controlInputWrapper.length) {\r\n          $controlInputWrapper.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important',\r\n            'position': 'relative !important'\r\n          });\r\n        }\r\n        \r\n        // Fix the control-input to match other fields\r\n        const $controlInput = this.$wrapper.find('.control-input');\r\n        if ($controlInput.length) {\r\n          $controlInput.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important',\r\n            'position': 'relative !important',\r\n            'height': 'var(--input-height) !important',\r\n            'line-height': 'var(--input-height) !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure wrapper styling matches other fields with higher specificity\r\n        this.$wrapper.css({\r\n          'margin': '0 !important',\r\n          'padding': '0 !important',\r\n          'vertical-align': 'top !important',\r\n          'display': 'block !important',\r\n          'position': 'relative !important',\r\n          'align-items': 'flex-start !important'\r\n        });\r\n        \r\n        // Ensure form column alignment with higher specificity\r\n        const $formColumn = this.$input.closest('.form-column');\r\n        if ($formColumn.length) {\r\n          $formColumn.css({\r\n            'vertical-align': 'top !important',\r\n            'display': 'flex !important',\r\n            'flex-direction': 'column !important',\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'align-items': 'stretch !important',\r\n            'justify-content': 'flex-start !important'\r\n          });\r\n        }\r\n        \r\n        // Target the specific form section to ensure proper alignment\r\n        const $formSection = this.$input.closest('.form-section');\r\n        if ($formSection.length) {\r\n          $formSection.css({\r\n            'display': 'flex !important',\r\n            'flex-direction': 'row !important',\r\n            'align-items': 'flex-start !important'\r\n          });\r\n        }\r\n        \r\n        // Remove any existing air-datepicker instances\r\n        this.removeAirDatepickerInstances();\r\n        \r\n        // Create Jalali datepicker\r\n        this.jalaliDatepicker = new JalaliDatepicker(this.$input[0], this);\r\n        \r\n        // Fix alignment after datepicker creation\r\n        this.fixFieldAlignment();\r\n      }\r\n      \r\n      fixFieldAlignment() {\r\n        // Ensure the entire field structure matches other fields\r\n        const $formGroup = this.$wrapper.find('.form-group');\r\n        if ($formGroup.length) {\r\n          $formGroup.css({\r\n            'margin-bottom': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure the clearfix div doesn't affect alignment\r\n        const $clearfix = this.$wrapper.find('.clearfix');\r\n        if ($clearfix.length) {\r\n          $clearfix.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure the control-label doesn't affect alignment\r\n        const $controlLabel = this.$wrapper.find('.control-label');\r\n        if ($controlLabel.length) {\r\n          $controlLabel.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important',\r\n            'line-height': 'normal !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure the help span doesn't affect alignment\r\n        const $help = this.$wrapper.find('.help');\r\n        if ($help.length) {\r\n          $help.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important'\r\n          });\r\n        }\r\n        \r\n        // Ensure the help-box doesn't affect alignment\r\n        const $helpBox = this.$wrapper.find('.help-box');\r\n        if ($helpBox.length) {\r\n          $helpBox.css({\r\n            'margin': '0 !important',\r\n            'padding': '0 !important',\r\n            'vertical-align': 'top !important',\r\n            'display': 'block !important'\r\n          });\r\n        }\r\n      }\r\n      \r\n      removeAirDatepickerInstances() {\r\n        // Remove any existing air-datepicker instances\r\n        if (this.datepicker) {\r\n          try {\r\n            this.datepicker.destroy();\r\n            this.datepicker = null;\r\n          } catch(e) {\r\n            console.log('Error destroying air-datepicker:', e);\r\n          }\r\n        }\r\n        \r\n        // Remove air-datepicker-related DOM elements\r\n        $('.air-datepicker').remove();\r\n        $('.datepicker-input').removeClass('datepicker-input');\r\n        $('.hasDatepicker').removeClass('hasDatepicker');\r\n        \r\n        // Remove any datepicker icons or buttons\r\n        $('.datepicker-icon').remove();\r\n        $('.datepicker-btn').remove();\r\n        \r\n        // Clear any datepicker-related data\r\n        if (this.$input && this.$input.length) {\r\n          this.$input.removeData('datepicker');\r\n        }\r\n        \r\n        // Remove any air-datepicker event listeners\r\n        if (this.$input && this.$input.length) {\r\n          this.$input.off('.datepicker');\r\n        }\r\n        \r\n        console.log('Air-datepicker instances removed for field:', this.df.fieldname);\r\n      }\r\n\r\n      set_formatted_input(value) {\r\n        try {\r\n          // Check cache first\r\n          const useJalali = calendarSettingsCache === null || \r\n                           (calendarSettingsCache.enabled && \r\n                            calendarSettingsCache.calendar?.display_calendar !== \"Gregorian\");\r\n          \r\n          // Check display calendar from instance, cache, or global\r\n          let display_calendar = this.display_calendar;\r\n          if (!display_calendar) {\r\n            if (calendarSettingsCache && calendarSettingsCache.calendar) {\r\n              display_calendar = calendarSettingsCache.calendar.display_calendar;\r\n            } else {\r\n              display_calendar = (EFFECTIVE_CALENDAR && EFFECTIVE_CALENDAR.display_calendar) || \"Jalali\";\r\n            }\r\n          }\r\n          \r\n          // Check if we should use Gregorian calendar (no conversion)\r\n          if (!useJalali || display_calendar === \"Gregorian\") {\r\n            // Use default Frappe behavior - show Gregorian dates as-is\r\n            // Don't convert to Jalali\r\n            console.log('set_formatted_input - Using Gregorian calendar, no conversion');\r\n            return super.set_formatted_input(value);\r\n          }\r\n\r\n          // Jalali calendar - convert Gregorian to Jalali for display\r\n          const r = super.set_formatted_input(value);\r\n\r\n          // Convert Gregorian to Jalali for display (only when Jalali is enabled)\r\n          if (value) {\r\n            console.log('set_formatted_input - Input value:', value, 'Display calendar:', display_calendar);\r\n            \r\n            // Parse the date more carefully\r\n            let gregorianDate;\r\n            if (typeof value === 'string') {\r\n              // Handle different date formats\r\n              if (value.includes('T')) {\r\n                gregorianDate = new Date(value);\r\n              } else if (value.includes('-')) {\r\n                gregorianDate = new Date(value + 'T00:00:00');\r\n              } else {\r\n                gregorianDate = new Date(value);\r\n              }\r\n            } else {\r\n              gregorianDate = new Date(value);\r\n            }\r\n            \r\n            console.log('set_formatted_input - Parsed date:', gregorianDate);\r\n            \r\n            if (!isNaN(gregorianDate.getTime())) {\r\n              const jalali = gToJ(gregorianDate);\r\n              const jalaliStr = formatJalaliDate(jalali.jy, jalali.jm, jalali.jd);\r\n              console.log('set_formatted_input - Jalali:', jalali, 'String:', jalaliStr);\r\n              this.$input.val(jalaliStr);\r\n              \r\n              // Update datepicker\r\n              if (this.jalaliDatepicker) {\r\n                this.jalaliDatepicker.updateDisplay();\r\n              }\r\n            } else {\r\n              console.log('set_formatted_input - Invalid date, keeping original value');\r\n            }\r\n          }\r\n\r\n          return r;\r\n        } catch(e) {\r\n          console.log('set_formatted_input error:', e);\r\n          return super.set_formatted_input(value);\r\n        }\r\n      }\r\n    }\r\n\r\n    frappe.ui.form.ControlDate = JalaliControlDate;\r\n    console.log(\"ControlDate patched for Jalali\");\r\n  }\r\n\r\n  // Function to remove all existing air-datepicker instances from the page\r\n  function removeAllAirDatepickerInstances() {\r\n    // Remove all air-datepicker calendars\r\n    $('.air-datepicker').remove();\r\n    \r\n    // Remove air-datepicker classes and attributes from all inputs\r\n    $('input.datepicker-input, input.hasDatepicker').each(function() {\r\n      $(this).removeClass('datepicker-input hasDatepicker');\r\n      $(this).removeAttr('data-date-format');\r\n      $(this).removeAttr('data-alt-input');\r\n      $(this).removeAttr('data-alt-format');\r\n      $(this).removeData('datepicker');\r\n      \r\n      // Remove event listeners\r\n      $(this).off('.datepicker');\r\n    });\r\n    \r\n    // Remove any datepicker icons or buttons\r\n    $('.datepicker-icon, .datepicker-btn').remove();\r\n    \r\n    // Remove any air-datepicker instances from global scope\r\n    if (window.Datepicker) {\r\n      try {\r\n        // Try to destroy all instances\r\n        Object.keys(window.Datepicker.instances || {}).forEach(key => {\r\n          try {\r\n            window.Datepicker.instances[key].destroy();\r\n          } catch(e) {\r\n            console.log('Error destroying air-datepicker instance:', e);\r\n          }\r\n        });\r\n      } catch(e) {\r\n        console.log('Error accessing air-datepicker instances:', e);\r\n      }\r\n    }\r\n    \r\n    console.log('Removed all air-datepicker instances from the page');\r\n  }\r\n  \r\n  // Remove existing air-datepicker instances immediately\r\n  removeAllAirDatepickerInstances();\r\n  \r\n  // Also remove them periodically to catch any dynamically created ones\r\n  setInterval(removeAllAirDatepickerInstances, 1000);\r\n\r\n  // Start overriding\r\n  overrideControlsWhenReady();\r\n\r\n  // Override Fiscal Year defaults to Jalali year boundaries when enabled\r\n  try {\r\n    frappe.ui.form.on('Fiscal Year', {\r\n      onload: async function(frm) {\r\n        try {\r\n          if (!frm.doc.__islocal) return; // only for new docs\r\n          \r\n          // Get calendar settings\r\n          const settings = await getCalendarSettings();\r\n          if (!settings.enabled) return;\r\n          if (settings.calendar && settings.calendar.display_calendar === 'Gregorian') return;\r\n\r\n          // If user already set a start date, don't override\r\n          if (frm.doc.year_start_date) return;\r\n\r\n          // Determine current Jalali year from today\r\n          const todayG = new Date();\r\n          const todayJ = gToJ(todayG);\r\n\r\n          const jy = todayJ.jy;\r\n          // Start: jy-01-01 (Jalali) => Gregorian\r\n          const startG = jToG(jy, 1, 1);\r\n          const startStr = `${startG.gy}-${String(startG.gm).padStart(2,'0')}-${String(startG.gd).padStart(2,'0')}`;\r\n\r\n          // End: next jy's 01-01 minus one day\r\n          const nextStartG = jToG(jy + 1, 1, 1);\r\n          const nextStartDate = new Date(nextStartG.gy, nextStartG.gm - 1, nextStartG.gd);\r\n          const endDate = new Date(nextStartDate.getTime() - 24 * 60 * 60 * 1000);\r\n          const endStr = `${endDate.getFullYear()}-${String(endDate.getMonth()+1).padStart(2,'0')}-${String(endDate.getDate()).padStart(2,'0')}`;\r\n\r\n          frm.set_value('year_start_date', startStr);\r\n          // If not short year, Frappe's handler sets end automatically; force set to Jalali end regardless\r\n          frm.set_value('year_end_date', endStr);\r\n        } catch (e) {\r\n          console.log('Error setting Jalali Fiscal Year defaults:', e);\r\n        }\r\n      }\r\n    });\r\n  } catch (e) {\r\n    console.log('Unable to attach Fiscal Year onload override:', e);\r\n  }\r\n\r\n  // Listen for User form calendar_preference changes and refresh page after save\r\n  // Only refresh if user is editing their own profile (My Settings)\r\n  try {\r\n    frappe.ui.form.on('User', {\r\n      after_save: function(frm) {\r\n        // Check if calendar_preference field exists and if user is editing their own profile\r\n        if (frm.doc.calendar_preference !== undefined && \r\n            frm.doc.name === frappe.session.user) {\r\n          console.log('User calendar_preference changed to:', frm.doc.calendar_preference);\r\n          console.log('Reloading page to apply new calendar settings...');\r\n          // Reload page to apply new calendar settings\r\n          setTimeout(function() {\r\n            window.location.reload();\r\n          }, 500);\r\n        }\r\n      }\r\n    });\r\n  } catch (e) {\r\n    console.log('Unable to attach User form handler:', e);\r\n  }\r\n\r\n})();", "(async function() {\r\n  // Check if Jalali calendar is enabled\r\n  let jalaliEnabled = false;\r\n  \r\n  try {\r\n    const result = await frappe.call({ method: \"persian_calendar.jalali_support.api.is_jalali_enabled\" });\r\n    jalaliEnabled = result && result.message;\r\n    console.log(\"Jalali calendar enabled:\", jalaliEnabled);\r\n  } catch(e) {\r\n    console.log(\"Error checking Jalali settings:\", e);\r\n    jalaliEnabled = false;\r\n  }\r\n\r\n  if (!jalaliEnabled) {\r\n    console.log(\"Jalali calendar is disabled, skipping formatters\");\r\n    return;\r\n  }\r\n\r\n  // Get effective calendar settings\r\n  let EFFECTIVE_CALENDAR = {\r\n    display_calendar: \"Jalali\",\r\n    week_start: 6,\r\n    week_end: 5\r\n  };\r\n  \r\n  try {\r\n    const r = await frappe.call({ method: \"persian_calendar.jalali_support.api.get_effective_calendar\" });\r\n    if (r && r.message) {\r\n      EFFECTIVE_CALENDAR = r.message;\r\n      console.log(\"Effective calendar settings in formatters:\", EFFECTIVE_CALENDAR);\r\n    }\r\n  } catch(e) {\r\n    console.log(\"Error fetching effective calendar in formatters:\", e);\r\n  }\r\n\r\n  function g2j_str(value) {\r\n    try {\r\n      // Parse as UTC to avoid TZ shifts and month off-by-one\r\n      const d = new Date(value + (value.length === 10 ? 'T00:00:00Z' : 'Z'));\r\n      if (isNaN(d)) return value;\r\n      const j = toJalali(d.getUTCFullYear(), d.getUTCMonth()+1, d.getUTCDate());\r\n      return `${j.jy}-${String(j.jm).padStart(2,\"0\")}-${String(j.jd).padStart(2,\"0\")}`;\r\n    } catch(e) {\r\n      return value;\r\n    }\r\n  }\r\n\r\n  // Helper function to check if we should convert to Jalali\r\n  function shouldConvertToJalali() {\r\n    return EFFECTIVE_CALENDAR && EFFECTIVE_CALENDAR.display_calendar === \"Jalali\";\r\n  }\r\n\r\n  // Global datetime helpers \u2192 force Jalali display in UI components (lists/reports)\r\n  const dt = frappe.datetime;\r\n  const orig_str_to_user = dt.str_to_user?.bind(dt);\r\n  const orig_str_to_user_with_default = dt.str_to_user_with_default?.bind(dt);\r\n  const orig_format_date = dt.format_date?.bind(dt);\r\n  const orig_format_datetime = dt.format_datetime?.bind(dt);\r\n\r\n  if (orig_str_to_user) {\r\n    dt.str_to_user = function(value) {\r\n      if (!value) return value;\r\n      \r\n      // Check if we should convert to Jalali\r\n      if (!shouldConvertToJalali()) {\r\n        // Use original function for Gregorian calendar\r\n        return orig_str_to_user(value);\r\n      }\r\n      \r\n      const is_datetime = typeof value === \"string\" && value.length > 10 && value.includes(\":\");\r\n      if (is_datetime) {\r\n        const date = value.slice(0, 10);\r\n        const time = value.slice(11, 19);\r\n        return `${g2j_str(date)} ${time}`.trim();\r\n      }\r\n      return g2j_str(value);\r\n    };\r\n  }\r\n  if (orig_str_to_user_with_default) {\r\n    dt.str_to_user_with_default = function(value) {\r\n      if (!value) return value;\r\n      \r\n      // Check if we should convert to Jalali\r\n      if (!shouldConvertToJalali()) {\r\n        return orig_str_to_user_with_default(value);\r\n      }\r\n      \r\n      return dt.str_to_user(value);\r\n    };\r\n  }\r\n  if (orig_format_date) {\r\n    dt.format_date = function(date_str) {\r\n      // Check if we should convert to Jalali\r\n      if (!shouldConvertToJalali()) {\r\n        return orig_format_date(date_str);\r\n      }\r\n      return g2j_str(date_str);\r\n    };\r\n  }\r\n  if (orig_format_datetime) {\r\n    dt.format_datetime = function(value) {\r\n      if (!value) return value;\r\n      \r\n      // Check if we should convert to Jalali\r\n      if (!shouldConvertToJalali()) {\r\n        return orig_format_datetime(value);\r\n      }\r\n      \r\n      const date = value.slice(0, 10);\r\n      const time = value.slice(11, 19) || \"\";\r\n      return `${g2j_str(date)} ${time}`.trim();\r\n    };\r\n  }\r\n\r\n  // Store original formatters\r\n  const orig_date_formatter = frappe.form.formatters.date;\r\n  const orig_datetime_formatter = frappe.form.formatters.datetime;\r\n\r\n  frappe.form.formatters.date = function(value, df, options, doc) {\r\n    if (!value) return value;\r\n    \r\n    // Check if we should convert to Jalali\r\n    if (!shouldConvertToJalali()) {\r\n      // Use original formatter for Gregorian calendar\r\n      if (orig_date_formatter) {\r\n        return orig_date_formatter(value, df, options, doc);\r\n      }\r\n      return value;\r\n    }\r\n    \r\n    return g2j_str(value);\r\n  };\r\n  \r\n  frappe.form.formatters.datetime = function(value, df, options, doc) {\r\n    if (!value) return value;\r\n    \r\n    // Check if we should convert to Jalali\r\n    if (!shouldConvertToJalali()) {\r\n      // Use original formatter for Gregorian calendar\r\n      if (orig_datetime_formatter) {\r\n        return orig_datetime_formatter(value, df, options, doc);\r\n      }\r\n      return value;\r\n    }\r\n    \r\n    const d = new Date(value);\r\n    if (isNaN(d)) return value;\r\n    const j = toJalali(d.getFullYear(), d.getMonth()+1, d.getDate());\r\n    const time = value.slice(11, 19) || \"\";\r\n    return `${j.jy}-${String(j.jm).padStart(2,\"0\")}-${String(j.jd).padStart(2,\"0\")} ${time}`;\r\n  };\r\n})();\r\n\r\n\r\n", "// Auto-refresh functionality for Jalali Settings\n// Wait for frappe to be available\n(function() {\n  function initAutoRefresh() {\n    if (typeof frappe !== 'undefined' && frappe.ui && frappe.ui.form) {\n      // Listen for form events on Jalali Settings\n      frappe.ui.form.on('Jalali Settings', {\n        after_save: function(frm) {\n          // Silently reload after save for Jalali Settings (no message)\n          setTimeout(function() {\n            window.location.reload();\n          }, 100);\n        }\n      });\n    } else {\n      // Retry after a short delay\n      setTimeout(initAutoRefresh, 100);\n    }\n  }\n\n  // Start initialization\n  initAutoRefresh();\n})();\n"],
  "mappings": "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",
  "names": ["toJalali", "toGregorian", "_a"]
}
